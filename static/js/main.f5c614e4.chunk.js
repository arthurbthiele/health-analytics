(this["webpackJsonphealth-analytics"]=this["webpackJsonphealth-analytics"]||[]).push([[0],{217:function(e,t,a){},497:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(50),s=a.n(r),o=(a(217),a(1)),l=function(e){var t=e.children;return Object(o.jsx)("div",{style:{width:window.innerWidth,height:window.innerHeight,display:"flex",alignItems:"center",justifyContent:"center"},children:t})},c=a(10),d=a(18),u=a(188),h="verdana",m={primary:{small:{fontSize:14,fontFamily:h},medium:{},large:{},display:{fontSize:20,fontFamily:h,color:"#d63e13"}},secondary:{footer:{fontSize:12,fontFamily:h,color:"#333333"},small:{},medium:{},large:{},display:{}}},f=function(e){var t=e.style,a=e.children;return Object(o.jsx)("div",{style:Object(d.a)(Object(d.a)({},m.primary.small),t),children:a})},v=a(129),b=a.n(v),p=a(130),j=a.n(p),g=a(17);var y=function(e){var t={attributeNamePrefix:"",attrNodeName:"attr",textNodeName:"#text",ignoreAttributes:!1,ignoreNameSpace:!1,allowBooleanAttributes:!1,parseNodeValue:!0,parseAttributeValue:!1,trimValues:!0,cdataTagName:"__cdata",cdataPositionChar:"\\c",parseTrueNumberOnly:!1,numParseOptions:{hex:!0,leadingZeros:!0},arrayMode:!1,attrValueProcessor:function(e){return b.a.decode(e,{isAttributeValue:!0})},tagValueProcessor:function(e){return b.a.decode(e)},stopNodes:["parse-me-as-string"]};if(!0===j.a.validate(e)){var a=j.a.parse(e,t);if(function(e){if(!e.HealthData)return!1;if(!e.HealthData.Record)return!1;var t,a=Object(g.a)(e.HealthData.Record);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(!n.attr)return!1;if(!n.attr.type)return!1}}catch(i){a.e(i)}finally{a.f()}return!0}(a))return a}},x=a(570);function O(e){var t=function(e){return Object(n.useCallback)((function(t){t.forEach((function(t){var a=new FileReader;a.onabort=function(){return console.log("file reading was aborted")},a.onerror=function(){return console.log("file reading has failed")},a.onload=function(){return setTimeout((function(){var t=a.result,n=y(t);void 0!==n?e(n):alert("Uploaded file does not have expected properties")}),1)},a.readAsText(t)}))}),[])}(e.onUpload),a=Object(u.a)({onDrop:t}),i=a.getRootProps,r=a.getInputProps;return Object(o.jsx)(x.a,{sx:{borderRadius:"16px",bgcolor:"background.paper",borderColor:"text.primary",m:1,border:1,width:240},children:Object(o.jsxs)("div",Object(d.a)(Object(d.a)({},i()),{},{children:[Object(o.jsx)("input",Object(d.a)({},r())),Object(o.jsx)(f,{style:{padding:"5px"},children:"Click here to upload an XML file"})]}))})}var S=a(23);function w(e){for(var t=e.start.startOf("day"),a=[];t<e.end;)a.push(t),t=t.plus({days:1});return a}var D=a(64);function T(e){var t,a=e.dataSet[0].x,n=e.dataSet[e.dataSet.length-1].x,i=w(S.Interval.fromDateTimes(a,n)),r=[],s=0,o=0,l=Object(g.a)(i);try{for(l.s();!(t=l.n()).done;){for(var c=t.value;e.dataSet[s].x<c;)s+=1;for(var u=c.plus({days:1});e.dataSet[o]&&e.dataSet[o].x<u;)o+=1;var h=e.dataSet.slice(s,o);r.push({x:c,y:Object(D.sum)(h.map((function(e){return e.y})))})}}catch(m){l.e(m)}finally{l.f()}return Object(d.a)(Object(d.a)({},e),{},{dataSet:r})}var A=["Step Count","Distance Walking Running","Basal Energy Burned","Active Energy Burned","Flights Climbed"];function k(e){var t={};return e.HealthData.Record.filter((function(e){return void 0!==e.attr.value&&void 0!==e.attr.startDate&&void 0!==e.attr.type&&void 0!==e.attr.unit})).forEach((function(e){var a=function(e){var t=S.DateTime.fromISO(function(e){var t=e.split(" ");return t[0]+"T"+t[1]+t[2]}(e.attr.startDate)),a=Number(e.attr.value);return{x:t,y:a}}(e),n=e.attr.type.replace("HKQuantityTypeIdentifier","").replace("HKDataType","").replace(/([a-z])([A-Z])/g,"$1 $2"),i=e.attr.unit;n in t?t[n].dataSet.push(a):t[n]={type:n,unit:i,dataSet:[a]}})),function(e){for(var t in e)A.includes(t)&&(console.log(t),e[t]=T(e[t]));return e}(function(e){for(var t=0,a=Object.values(e);t<a.length;t++){a[t].dataSet.sort((function(e,t){return e.x.diff(t.x).milliseconds}))}return e}(t))}var C=a(564),M=a(559),I=a(547),R=a(558);function H(e){var t=e.handleChange,a=e.value;return Object(o.jsx)(I.b,{dateAdapter:M.a,children:Object(o.jsx)(R.a,{label:"Analytics Date",inputFormat:"dd/MM/yyyy",value:a,onChange:t,renderInput:function(e){return Object(o.jsx)(C.a,Object(d.a)({},e))}})})}var W=a(566),N=a(562),P=a(565),B=a(560);function E(e){var t=e.timeseriesCollection,a=e.selectedTimeseries,n=e.setSelectedTimeseries;return Object(o.jsx)(x.a,{sx:{minWidth:120,maxWidth:500,padding:1},children:Object(o.jsxs)(P.a,{fullWidth:!0,children:[Object(o.jsx)(W.a,{id:"timeseries-select",children:"Data Set"}),Object(o.jsx)(B.a,{labelId:"timeseries-select-label",id:"timeseries-select",value:a,label:"Select a data type to explore",onChange:function(e){n(e.target.value)},children:Object.values(t).map((function(e,t){return Object(o.jsx)(N.a,{value:e.type,children:e.type},t)}))})]})})}var V=a(186),z=a.n(V),F=[{name:"Height",unit:"cm",statistics:{mean:180,dev:.01}},{name:"Body Mass",unit:"kg",statistics:{mean:70,dev:2}},{name:"Heart Rate",unit:"count/min",statistics:{mean:70,dev:15}},{name:"Step Count",unit:"count",statistics:{mean:1e3,dev:100}},{name:"Distance Walking Running",unit:"km",statistics:{mean:1,dev:.3}},{name:"Basal Energy Burned",unit:"kJ",statistics:{mean:300,dev:10}},{name:"Active Energy Burned",unit:"kJ",statistics:{mean:200,dev:20}},{name:"Flights Climbed",unit:"count",statistics:{mean:4,dev:1}},{name:"Apple Exercise Time",unit:"min",statistics:{mean:1,dev:.01}},{name:"Resting Heart Rate",unit:"count/min",statistics:{mean:60,dev:10}},{name:"VO2Max",unit:"mL/min\xb7kg",statistics:{mean:1,dev:.2}},{name:"Walking Heart Rate Average",unit:"count/min",statistics:{mean:100,dev:15}},{name:"Environmental Audio Exposure",unit:"dBASPL",statistics:{mean:70,dev:5}},{name:"Headphone Audio Exposure",unit:"dBASPL",statistics:{mean:65,dev:10}},{name:"Walking Double Support Percentage",unit:"%",statistics:{mean:.28,dev:.02}},{name:"Six Minute Walk Test Distance",unit:"m",statistics:{mean:500,dev:1}},{name:"Apple Stand Time",unit:"min",statistics:{mean:3.5,dev:.5}},{name:"Walking Speed",unit:"km/hr",statistics:{mean:4,dev:1}},{name:"Walking Step Length",unit:"cm",statistics:{mean:65,dev:8}},{name:"Walking Asymmetry Percentage",unit:"%",statistics:{mean:.2,dev:.01}},{name:"Stair Ascent Speed",unit:"m/s",statistics:{mean:.4,dev:.06}},{name:"Stair Descent Speed",unit:"m/s",statistics:{mean:.5,dev:.06}},{name:"Sleep Duration Goal",unit:"hr",statistics:{mean:7.5,dev:.2}},{name:"Heart Rate Variability SDNN",unit:"ms",statistics:{mean:80,dev:15}}];function G(e){var t=e.onDataGeneration;return Object(o.jsx)(x.a,{sx:{borderRadius:"16px",bgcolor:"background.paper",borderColor:"text.primary",m:1,border:1,width:180},onClick:function(){return t(function(){var e,t=S.DateTime.now(),a=S.DateTime.now().minus({days:200}),n=w(S.Interval.fromDateTimes(a,t)),i={},r=Object(g.a)(F);try{var s=function(){var t=e.value,a=z()(t.statistics.mean,t.statistics.dev),r=n.map((function(e){return{x:e,y:a.next().value}}));i[t.name]={type:t.name,unit:t.unit,dataSet:r}};for(r.s();!(e=r.n()).done;)s()}catch(o){r.e(o)}finally{r.f()}return i}())},children:Object(o.jsx)(f,{style:{padding:"5px"},children:"Generate Random Data"})})}function J(e){var t=e.dataSet.length;if(0===t)return{count:t};var a=Object(D.mean)(e.dataSet.map((function(e){return e.y})));return 1===t?{count:t,average:a}:{count:t,average:a,deviation:Object(D.sampleStandardDeviation)(e.dataSet.map((function(e){return e.y})))}}function L(e,t){var a=function(e,t){var a=t.dataSet;if(0===a.length)return{before:t,after:t};if(a[0].x.diff(e).milliseconds>0)return{before:Object(d.a)(Object(d.a)({},t),{},{dataSet:[]}),after:t};if(a[a.length-1].x.diff(e).milliseconds<0)return{before:t,after:Object(d.a)(Object(d.a)({},t),{},{dataSet:[]})};var n=a.findIndex((function(t){return t.x.diff(e).milliseconds>0})),i={type:t.type,unit:t.unit};return{before:Object(d.a)(Object(d.a)({},i),{},{dataSet:t.dataSet.slice(0,n)}),after:Object(d.a)(Object(d.a)({},i),{},{dataSet:t.dataSet.slice(n)})}}(t,e),n=J(a.before),i=J(a.after),r=n.average&&i.average?n.average<i.average?"less":"greater":void 0;if(!n.average||!i.average)return{before:n,after:i};var s=Object(D.permutationTest)(a.before.dataSet.map((function(e){return e.y})),a.after.dataSet.map((function(e){return e.y})),r);return{before:n,after:i,pValue:s<1e-4?"<0.0001":s.toString()}}var U=a(573),_=a(577),K=a(576),Z=a(572),$=a(574),Q=a(575),X=a(571);function Y(e){var t=e.timeseries,a=e.analyticsDate,i=e.analytics,r=e.setAnalytics;function s(e,t,a,n){return{name:e,count:t,average:a,deviation:n}}Object(n.useEffect)((function(){setTimeout((function(){r(L(t,a))}),1)}),[t,a]);var l=[s("Analysis Prior to Selected Date",(null===i||void 0===i?void 0:i.before.count)||0,(null===i||void 0===i?void 0:i.before.average)||"-",(null===i||void 0===i?void 0:i.before.deviation)||"-"),s("Analysis After Selected Date",(null===i||void 0===i?void 0:i.after.count)||0,(null===i||void 0===i?void 0:i.after.average)||"-",(null===i||void 0===i?void 0:i.after.deviation)||"-")];return Object(o.jsxs)("div",{children:[Object(o.jsx)(Z.a,{component:X.a,children:Object(o.jsxs)(U.a,{sx:{minWidth:650},"aria-label":"simple table",children:[Object(o.jsx)($.a,{children:Object(o.jsxs)(Q.a,{children:[Object(o.jsx)(K.a,{children:"Analysis Section"}),Object(o.jsx)(K.a,{align:"right",children:"Record Count"}),Object(o.jsx)(K.a,{align:"right",children:"Mean"}),Object(o.jsx)(K.a,{align:"right",children:"Sample Standard Deviation"})]})}),Object(o.jsx)(_.a,{children:l.map((function(e){return Object(o.jsxs)(Q.a,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[Object(o.jsx)(K.a,{component:"th",scope:"row",children:e.name}),Object(o.jsx)(K.a,{align:"right",children:e.count}),Object(o.jsx)(K.a,{align:"right",children:e.average}),Object(o.jsx)(K.a,{align:"right",children:e.deviation})]},e.name)}))})]})}),void 0!==(null===i||void 0===i?void 0:i.pValue)&&Object(o.jsxs)("div",{style:{paddingTop:10},children:["Under a"," ",Object(o.jsx)("a",{href:"https://en.wikipedia.org/wiki/Permutation_test",children:"Permutation Test"}),", this data separation has a p-value of ",null===i||void 0===i?void 0:i.pValue,". ",Object(o.jsx)("br",{}),"This means that a difference in value of this great or greater has a"," ",null===i||void 0===i?void 0:i.pValue," chance of occurring if the underlying populations are identical. In general, a lower p-value suggests that there is a meaningful difference between the two populations."]})]})}var q=a(15),ee=a(191);a(496);function te(e){var t,a,n,i,r=e.timeseries,s=e.analyticsDate,l=e.analytics,c={labels:r.dataSet.map((function(e){return e.x.toMillis()})),datasets:[{label:r.type,backgroundColor:"rgba(75,192,192,1)",borderColor:"rgba(0,0,0,1)",borderWidth:2,data:r.dataSet.map((function(e){return{x:e.x.toMillis(),y:e.y}}))}]};if(s&&null!==(t=null===l||void 0===l||null===(a=l.before)||void 0===a?void 0:a.count)&&void 0!==t&&t&&null!==(n=null===l||void 0===l||null===(i=l.after)||void 0===i?void 0:i.count)&&void 0!==n&&n){var u=function(e,t){return Object(d.a)(Object(d.a)({label:"Analytics Date"},ae),{},{data:[{x:e.toMillis(),y:Math.max.apply(Math,Object(q.a)(t.dataSet.map((function(e){return e.y}))))},{x:e.toMillis(),y:Math.min.apply(Math,Object(q.a)(t.dataSet.map((function(e){return e.y}))))}]})}(s,r),h=function(e,t,a){var n,i;return Object(d.a)(Object(d.a)({label:"Average Before"},ae),{},{data:[{x:t.dataSet[0].x.toMillis(),y:null!==(n=null===a||void 0===a?void 0:a.before.average)&&void 0!==n?n:0},{x:e.toMillis(),y:null!==(i=null===a||void 0===a?void 0:a.before.average)&&void 0!==i?i:0}]})}(s,r,l),m=function(e,t,a){var n,i;return Object(d.a)(Object(d.a)({label:"Average After"},ae),{},{data:[{x:e.toMillis(),y:null!==(n=null===a||void 0===a?void 0:a.after.average)&&void 0!==n?n:0},{x:t.dataSet[t.dataSet.length-1].x.toMillis(),y:null!==(i=null===a||void 0===a?void 0:a.after.average)&&void 0!==i?i:0}]})}(s,r,l);c.datasets.push(u,h,m)}return Object(o.jsx)(ee.a,{data:c,options:{onHover:null,parsing:!1,plugins:{decimation:{enabled:!0,algorithm:"lttb",samples:1e3}},title:{display:!0,text:r.type},legend:{display:!0,position:"right"},scales:{x:{type:"time",display:!0,title:{display:!0}},y:{display:!0,title:{display:!0,text:r.unit}}}}})}var ae={borderColor:"rgba(255,0,0,0.5)",backgroundColor:"rgba(255,0,0,0.5)"};function ne(){var e,t=Object(n.useState)(),a=Object(c.a)(t,2),r=a[0],s=a[1],l=Object(n.useState)(""),d=Object(c.a)(l,2),u=d[0],h=d[1],m=i.a.useState(S.DateTime.now()),f=Object(c.a)(m,2),v=f[0],b=f[1],p=Object(n.useState)(),j=Object(c.a)(p,2),g=j[0],y=j[1];return Object(o.jsxs)("div",{style:{padding:24,width:"60%",height:"100%",position:"absolute",left:0,top:0},children:[" ",Object(o.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(o.jsx)(O,{onUpload:function(e){s(k(e))}}),Object(o.jsx)(G,{onDataGeneration:function(e){s(e)}}),Object(o.jsx)(H,{handleChange:function(e){e&&b(S.DateTime.fromJSDate(e))},value:null!==(e=null===v||void 0===v?void 0:v.toJSDate())&&void 0!==e?e:null})]}),!!r&&Object(o.jsx)(E,{timeseriesCollection:r,selectedTimeseries:u,setSelectedTimeseries:h}),!!r&&!!r[u]&&Object(o.jsx)(te,{timeseries:r[u],analyticsDate:v,analytics:g}),!!r&&!!r[u]&&!!v&&Object(o.jsx)(Y,{timeseries:r[u],analyticsDate:v,analytics:g,setAnalytics:y})]})}function ie(){return Object(o.jsxs)(f,{style:{position:"absolute",top:0,right:0,width:"30%",padding:50,fontSize:"large"},children:["The Apple Watch gathers a lot of useful data. However, the inbuilt data analysis is missing some features I want. I have made this site in an attempt to create some of those features. These include:",Object(o.jsxs)("ul",{children:[Object(o.jsxs)("li",{children:["Basic statistical summaries, like averages and standard deviations."," "]}),Object(o.jsxs)("li",{children:["Splitting input data on a supplied date, and testing to see if there has been a significant change in the timeseries before vs. after the supplied date. If so, I want to see the nature of that change."," "]}),Object(o.jsx)("li",{children:"Clearer graphical visualisations."})]}),"If you have an Apple Watch and want to use this site, first"," ",Object(o.jsx)("a",{href:"https://www.computerworld.com/article/2889310/how-to-export-apple-health-data-as-a-document-to-share.html?page=2",children:"export"})," ","your data. Then, use the button at the top left to upload the main .xml file in the generated .zip. Depending on the file size, this may take some time (~10s for my 100MB file). You can then browse through your data."," ",Object(o.jsx)("br",{}),"If you want to test the features without uploading data, click the Generate Random Data button. This generates reasonably realistic data for the last 201 days, on which data analysis can be done. To use the data analysis features, set the datepicker to a date where you think something might have changed (e.g. started a new medication, started a gym program, etc). Note that this feature will only work if you provide a date that is within the range of your data set.",Object(o.jsx)("br",{}),"This is an open source project. The code is stored"," ",Object(o.jsx)("a",{href:"https://github.com/arthurbthiele/health-monitor",children:"here"}),". Please suggest changes as Github issues there, or send me an email at: ",Object(o.jsx)("br",{}),"arthurbthiele (at) gmail.com",Object(o.jsx)("br",{}),"All calculations are performed entirely in browser, and no information is collected or stored about any user anywhere but their browser. No information is retained after a user ends their session. ",Object(o.jsx)("br",{}),"This site is intended mainly to satisfy curiosity - if you are in need of health advice, please consult a medical professional."]})}var re=function(){return Object(o.jsxs)(l,{children:[Object(o.jsx)(ne,{}),Object(o.jsx)(ie,{})]})};document.title="Health Analytics",s.a.render(Object(o.jsx)(i.a.StrictMode,{children:Object(o.jsx)(re,{})}),document.getElementById("root"))}},[[497,1,2]]]);
//# sourceMappingURL=main.f5c614e4.chunk.js.map