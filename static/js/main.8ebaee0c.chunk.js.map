{"version":3,"sources":["components/PageContainer.tsx","assets/fonts.ts","assets/colors.ts","components/Text.tsx","utilities/xmlParser.ts","utilities/validateUpload.ts","components/FileUploader.tsx","utilities/processData.ts","components/HeartRateGraph.tsx","components/DateInput.tsx","components/DataContainer.tsx","App.tsx","index.tsx"],"names":["PageContainer","children","style","width","window","innerWidth","height","innerHeight","display","alignItems","justifyContent","padding","position","left","top","fontFamily","fonts","primary","small","fontSize","medium","large","color","secondary","footer","Text","parseXML","xmlData","options","attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","ignoreNameSpace","allowBooleanAttributes","parseNodeValue","parseAttributeValue","trimValues","cdataTagName","cdataPositionChar","parseTrueNumberOnly","numParseOptions","hex","leadingZeros","arrayMode","attrValueProcessor","val","he","decode","isAttributeValue","tagValueProcessor","stopNodes","parser","validate","jsonObj","parse","inputJson","HealthData","Record","element","attr","type","FileUploader","onDrop","onUpload","useCallback","acceptedFiles","forEach","file","reader","FileReader","onabort","console","log","onerror","onload","setTimeout","textString","result","parsedXML","undefined","alert","readAsText","getOnDrop","useDropzone","getRootProps","getInputProps","processData","heartRateRaw","filter","value","startDate","heartRates","push","startTime","moment","heartRate","parseInt","t","y","getHeartRateDataPoint","HeartRateGraph","heartRateData","state","labels","map","datum","datasets","label","backgroundColor","borderColor","borderWidth","data","title","text","legend","DateInput","DataContainer","useState","setHeartRateData","input","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.8ebaee0c.chunk.js","sourcesContent":["import React, { ReactElement, ReactNode } from \"react\";\n\nexport const PageContainer = ({\n  children,\n}: {\n  children: ReactNode;\n}): ReactElement => (\n  <div\n    style={{\n      width: window.innerWidth,\n      height: window.innerHeight,\n      display: \"flex\",\n      alignItems: \"center\",\n      justifyContent: \"center\",\n    }}\n  >\n    <div\n      style={{\n        padding: 24,\n        width: \"100%\",\n        height: \"100%\",\n        position: \"absolute\",\n        left: 0,\n        top: 0,\n      }}\n    >\n      {children}\n    </div>\n  </div>\n);\n","import { colors } from \"./colors\";\n\nconst fontSize = {\n  footer: 12,\n  small: 14,\n  medium: 16,\n  large: 20,\n};\nconst fontFamily = \"verdana\";\nexport const fonts = {\n  primary: {\n    small: { fontSize: fontSize.small, fontFamily },\n    medium: {},\n    large: {},\n    display: { fontSize: fontSize.large, fontFamily, color: colors.red },\n  },\n  secondary: {\n    footer: { fontSize: fontSize.footer, fontFamily, color: colors.grey },\n    small: {},\n    medium: {},\n    large: {},\n    display: {},\n  },\n};\n","export const colors = {\n  red: \"#d63e13\",\n  green: \"green\",\n  lightBlue: \"#99c3fa\",\n  darkBlue: \"#8ab0e1\",\n  grey: \"#333333\",\n};\n","import { fonts } from \"../assets/fonts\";\nimport React, { CSSProperties, ReactElement, ReactNode } from \"react\";\n\nexport const Text = ({\n  style,\n  children,\n}: {\n  style?: CSSProperties;\n  children: ReactNode;\n}): ReactElement => (\n  <div style={{ ...fonts.primary.small, ...style }}>{children}</div>\n);\n","import he from \"he\";\n\nimport parser from \"fast-xml-parser\";\nimport { UploadData, validate } from \"./validateUpload\";\n\nexport const parseXML = (xmlData: string): UploadData | undefined => {\n  interface Options {\n    ignoreAttributes: boolean;\n    attrValueProcessor: (val: string) => string;\n    attrNodeName: string;\n    trimValues: boolean;\n    textNodeName: string;\n    cdataTagName: string;\n    attributeNamePrefix: string;\n    parseAttributeValue: boolean;\n    parseNodeValue: boolean;\n    parseTrueNumberOnly: boolean;\n    cdataPositionChar: string;\n    arrayMode: boolean;\n    numParseOptions: { hex: boolean; leadingZeros: boolean };\n    tagValueProcessor: (val: string) => string;\n    ignoreNameSpace: boolean;\n    allowBooleanAttributes: boolean;\n    stopNodes: string[];\n  }\n\n  const options: Options = {\n    attributeNamePrefix: \"\",\n    attrNodeName: \"attr\", //default is 'false'\n    textNodeName: \"#text\",\n    ignoreAttributes: false,\n    ignoreNameSpace: false,\n    allowBooleanAttributes: false,\n    parseNodeValue: true,\n    parseAttributeValue: false,\n    trimValues: true,\n    cdataTagName: \"__cdata\", //default is 'false'\n    cdataPositionChar: \"\\\\c\",\n    parseTrueNumberOnly: false,\n    numParseOptions: {\n      hex: true,\n      leadingZeros: true,\n      //skipLike: /\\+[0-9]{10}/\n    },\n    arrayMode: false, //\"strict\"\n    attrValueProcessor: (val) => he.decode(val, { isAttributeValue: true }), //default is a=>a\n    tagValueProcessor: (val) => he.decode(val), //default is a=>a\n    stopNodes: [\"parse-me-as-string\"],\n  };\n\n  if (parser.validate(xmlData) === true) {\n    //optional (it'll return an object in case it's not valid)\n    const jsonObj = parser.parse(xmlData, options);\n    if (validate(jsonObj)) {\n      return jsonObj;\n    }\n  }\n  return undefined;\n};\n","/* eslint-disable-next-line @typescript-eslint/no-explicit-any */\nfunction validate(inputJson: Record<string, any>): inputJson is UploadData {\n  if (!inputJson.HealthData) return false;\n  if (!inputJson.HealthData.Record) return false;\n  for (const element of inputJson.HealthData.Record) {\n    if (!element.attr) return false;\n    if (!element.attr.type) return false;\n  }\n  return true;\n}\n\ninterface UploadData {\n  HealthData: {\n    Record: Element[];\n  };\n}\n\ninterface Element {\n  attr: Attribute;\n}\n\ninterface Attribute {\n  type: string;\n  value?: string;\n  startDate?: string;\n}\n\nexport { validate };\nexport type { UploadData, Element, Attribute };\n","import React, { ReactElement, useCallback } from \"react\";\nimport { useDropzone } from \"react-dropzone\";\nimport { Text } from \"./Text\";\nimport { parseXML } from \"../utilities/xmlParser\";\nimport { UploadData } from \"../utilities/validateUpload\";\n\nfunction getOnDrop(onUpload: (input: UploadData) => void) {\n  return useCallback((acceptedFiles) => {\n    acceptedFiles.forEach((file: File) => {\n      const reader = new FileReader();\n\n      reader.onabort = () => console.log(\"file reading was aborted\");\n      reader.onerror = () => console.log(\"file reading has failed\");\n      reader.onload = () =>\n        setTimeout(() => {\n          const textString = reader.result;\n          const parsedXML = parseXML(textString as string);\n          if (parsedXML !== undefined) {\n            onUpload(parsedXML);\n          } else {\n            alert(\"Uploaded file does not have expected properties\");\n          }\n        }, 1);\n      reader.readAsText(file);\n    });\n  }, []);\n}\n\nexport function FileUploader({\n  onUpload,\n}: {\n  onUpload: (input: UploadData) => void;\n}): ReactElement {\n  const onDrop = getOnDrop(onUpload);\n  const { getRootProps, getInputProps } = useDropzone({ onDrop });\n\n  return (\n    <div {...getRootProps()}>\n      <input {...getInputProps()} />\n      <Text>Click here to upload an XML file</Text>\n    </div>\n  );\n}\n","import moment from \"moment\";\nimport { UploadData, Element } from \"./validateUpload\";\n\nexport interface HeartRateDatum {\n  t: moment.Moment;\n  y: number;\n}\n\nexport function processData(inputJson: UploadData): HeartRateDatum[] {\n  const heartRateRaw = inputJson.HealthData.Record.filter(\n    (element: Element): element is RawHeartRateDatum =>\n      element.attr.type === \"HKQuantityTypeIdentifierRestingHeartRate\" &&\n      element.attr.value !== undefined &&\n      element.attr.startDate !== undefined\n  );\n\n  const heartRates: HeartRateDatum[] = [];\n  heartRateRaw.forEach((element) =>\n    heartRates.push(getHeartRateDataPoint(element))\n  );\n  return heartRates;\n}\n\ninterface RawHeartRateDatum {\n  attr: HeartRateAttribute;\n}\n\ninterface HeartRateAttribute {\n  type: string;\n  value: string;\n  startDate: string;\n}\n\nfunction getHeartRateDataPoint(element: RawHeartRateDatum): HeartRateDatum {\n  const startTime = moment(element.attr.startDate);\n  // console.log(element.attr.startDate); // todo: figure out what's going on with moment\n  const heartRate = parseInt(element.attr.value);\n  const heartRateDatum = { t: startTime, y: heartRate };\n  return heartRateDatum;\n}\n","import React, { ReactElement } from \"react\";\nimport { HeartRateDatum } from \"../utilities/processData\";\nimport { Line } from \"react-chartjs-2\";\n\nexport function HeartRateGraph({\n  heartRateData,\n}: {\n  heartRateData: HeartRateDatum[];\n}): ReactElement {\n  const state = {\n    labels: heartRateData.map((datum) => datum.t),\n    datasets: [\n      {\n        label: \"Rainfall\",\n        backgroundColor: \"rgba(75,192,192,1)\",\n        borderColor: \"rgba(0,0,0,1)\",\n        borderWidth: 2,\n        data: heartRateData.map((datum) => datum.y),\n      },\n    ],\n  };\n  return (\n    <Line\n      data={state}\n      options={\n        {\n          title: {\n            display: true,\n            text: \"Average Rainfall per month\",\n          },\n          legend: {\n            display: true,\n            position: \"right\",\n          },\n        } as any // eslint-disable-line @typescript-eslint/no-explicit-any\n      }\n    />\n  );\n}\n","import React, { ReactElement } from \"react\";\n// import moment from \"moment\";\n\nexport function DateInput(): ReactElement {\n  // setLifestyleChangeDate: React.Dispatch<\n  //   React.SetStateAction<moment.Moment | undefined>\n  // >\n  return <div />;\n}\n","import React, { ReactElement, useState } from \"react\";\nimport { FileUploader } from \"./FileUploader\";\nimport { HeartRateDatum, processData } from \"../utilities/processData\";\nimport { HeartRateGraph } from \"./HeartRateGraph\";\nimport { UploadData } from \"../utilities/validateUpload\";\nimport { DateInput } from \"./DateInput\";\n// import moment from \"moment\";\n\nexport function DataContainer(): ReactElement {\n  const [heartRateData, setHeartRateData] = useState<HeartRateDatum[]>([]);\n  // const [lifestyleChangeDate, setLifestyleChangeDate] = useState<\n  //   moment.Moment | undefined\n  // >(undefined);\n\n  function onUpload(input: UploadData): void {\n    setHeartRateData(processData(input));\n  }\n\n  return (\n    <div>\n      <FileUploader onUpload={onUpload} />\n      <DateInput />\n      <HeartRateGraph heartRateData={heartRateData} />\n    </div>\n  );\n}\n","import React, { ReactElement } from \"react\";\nimport { PageContainer } from \"./components\";\nimport { DataContainer } from \"./components/DataContainer\";\n\nfunction App(): ReactElement {\n  return (\n    <PageContainer>\n      <DataContainer />\n    </PageContainer>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}